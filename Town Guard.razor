#Script by Brozan
#Designed to recall to first 4 runes in a runebook
# and search for non-green tracking targets

//overhead 'Select runebook'
@setvar! 'myrunebook' 0x51FC0368

createtimer 'hiding'
settimer 'hiding' 20000

createtimer 'stay'
settimer 'stay' 20000

createtimer 'spam message'
settimer 'spam message' 20000

createtimer 'alls well'
settimer 'spam message' 20000
overhead 'Make sure tracking is on!'
wait 500
overhead 'Make sure tracking is on!'
wait 500
overhead 'Make sure tracking is on!'
wait 500
overhead 'Make sure tracking is on!'
wait 500
guild 'Town Guard has been ACTIVATED'
while not dead  
    ######################
    #The fun section
    if timer 'alls well' > 1800000
        guild 'Detection Bot has lived for another 30 minutes and ALLS WELL'
        settimer 'alls well' 0
    endif
    
    
    ######################
    # Location 1-1
    overhead 'Location 1-1'
    dclick 'myrunebook'
    waitforgump 1551740969
    gumpresponse 5
    wait 4000
    
    //This is the bank restock rune 
    //Restock agent on self
    say 'Guards!  Please open my bank!'
    wait 500
    restock 1
    wait 500
    target self
    wait 5000
    clearsysmsg 
    
    ######################
    # Location 1-2
    #North Side
    overhead 'Location 1-2'
    dclick 'myrunebook'
    waitforgump 1551740969
    gumpresponse 11
    wait 4000
    clearsysmsg 
    
    
    //We should be at new location, now hide
    wait 200
    if timer 'hiding' > 10000
        hotkey 'Hiding'
        settimer 'hiding' 0
    endif    
    
    settimer stay 0
    while timer 'stay' < 90000
        #overhead 'Parking it'       
        # Tracking
        if insysmsg 'Now tracking:'
            if timer 'spam message' > 15000
                guild 'PK Near North Side!!'
                settimer 'spam message' 0
                
                //guild warned, now gtfo
                dclick 'myrunebook'
                waitforgump 1551740969
                gumpresponse 5
                wait 3000
                guild 'PK Near  North Side!! - Second call!!'
                wait 3000
                guild 'PK Near  North Side!! - Last call!!'                
            endif
            clearsysmsg
        endif
        wait 500
    endwhile
    ######################
    # Location 2-3
    #Tul Rru
    overhead 'Location 2-3'
    dclick 'myrunebook'
    waitforgump 1551740969
    gumpresponse 17
    wait 4000
    clearsysmsg 
    
    
    //We should be at new location, now hide
    wait 200
    if timer 'hiding' > 10000
        hotkey 'Hiding'
        settimer 'hiding' 0
    endif    
    
    settimer stay 0
    while timer 'stay' < 15000
        # Tracking
        if insysmsg 'Now tracking:'
            if timer 'spam message' > 15000
                guild 'PK Near Tul Rru!!'
                settimer 'spam message' 0
                
                //guild warned, now gtfo
                dclick 'myrunebook'
                waitforgump 1551740969
                gumpresponse 5
                wait 3000
                guild 'PK Near Tul Rru!! - Second call!!'
                wait 3000
                guild 'PK Near Tul Rru!! - Last call!!'                
            endif
            clearsysmsg
        endif
        wait 500
    endwhile
    ######################
    # Location 2-4
    #Fallen Manor
    overhead 'Location 3-4'
    dclick 'myrunebook'
    waitforgump 1551740969
    gumpresponse 23
    wait 4000
    clearsysmsg 
    
    
    //We should be at new location, now hide
    wait 200
    if timer 'hiding' > 10000
        hotkey 'Hiding'
        settimer 'hiding' 0
    endif    
    
    settimer stay 0
    while timer 'stay' < 15000
        #overhead 'Parking it'       
        # Tracking
        if insysmsg 'Now tracking:'
            if timer 'spam message' > 15000
                guild 'PK Near Fallen Manor!!'
                settimer 'spam message' 0
                
                //guild warned, now gtfo
                dclick 'myrunebook'
                waitforgump 1551740969
                gumpresponse 5
                wait 3000
                guild 'PK Near Fallen Manor!! - Second call!!'
                wait 3000
                guild 'PK Near Fallen Manor!! - Last call!!'                
            endif
            clearsysmsg
        endif
        wait 500
    endwhile
    ######################
    # Location 3-5
    //This is our "park" location so we will stay here for a while
    overhead 'Location 3-5'
    dclick 'myrunebook'
    waitforgump 1551740969
    gumpresponse 29
    wait 4000
    clearsysmsg 
    
    
    //We should be at new location, now hide
    wait 200
    if timer 'hiding' > 10000
        hotkey 'Hiding'
        settimer 'hiding' 0
    endif    
    
    settimer stay 0
    while timer 'stay' < 120000
        #overhead  'Parking it'       
        # Tracking
        if insysmsg 'Now tracking:'
            if timer 'spam message' > 15000
                guild 'PK Near Bog Side!!'
                settimer 'spam message' 0
                
                //guild warned, now gtfo
                dclick 'myrunebook'
                waitforgump 1551740969
                gumpresponse 5
                wait 3000
                guild 'PK Near Bog Side!! - Second call!!'
                wait 3000
                guild 'PK Near Bog Side!! - Last call!!'                
            endif
            clearsysmsg
        endif
        wait 500
    endwhile
endwhile

wait 5000
guild 'Someone ping Brozan on Discrod and tell him I am dead!'
wait 900000
guild 'Someone ping Brozan on Discrod and tell him I am dead!'
wait 1800000
guild 'Someone ping Brozan on Discrod and tell him I am dead!'
    