# Clear sys messaages
clearsysmsg

#Change this to your Summoning Stone
@setvar sumStone 0x4ABCDFE4

if not timerexists "healpot"
    createtimer "healpot"
    settimer "healpot" 8000
endif

if not timerexists "shroomy"
    createtimer "shroomy"
    settimer "shroomy" 61000
endif

hotkey 'Forensics'
waitfortarget 1000
hotkey 'Target Self'
wait 700
hotkey 'Spirit Speak'
wait 350
dclick 'sumStone'
waitfortarget  1050
target 'sumStone'


while not dead
        
    # If hidden, skip
    if hidden
        continue
    endif

    
    if insysmsg 'you cannot move!'
        overhead 'Paralyzed!' 34
        say [pouch
    endif
    
    #Eat a magic mushroom if we have 
    #25  less mana than full
    if mana < 60 and timer "shroomy" >= 61000
        dclicktype '29012'
        overhead 'Mushroom Power!'
        settimer "shroomy" 0
    endif

    if not findtype "Yellow Potion" backpack
        overhead 'Out of heal potions!' 34
        wait 200
    endif
    
    //Heal drinker if below 40
    if hp < 40
       if findtype "Yellow Potion" backpack
           if timer "healpot" >= 8000
                        overhead 'Drinking heal!'
                        potion "heal"
                        wait 200
                        settimer "healpot" 0
            endif
         endif
     endif
    
    //Caches Moongate Clicker  
    if findtype 3948 'ground' 2822 1 2 as 'yellowmoongate'
        dclick 'yellowmoongate'
        waitforgump 3773199800
        gumpresponse 14
        waitforgump 3773199800
        gumpresponse 2
    endif

    if findtype 3948 'ground' 2820 1 2  as 'redmoongate'
        dclick 'redmoongate'
        waitforgump 3773199800
        gumpresponse 14
        waitforgump 3773199800
        gumpresponse 2
    endif
     
     wait 100
endwhile