#Script by Brozan
#Make sure to have a runebook
# or recall rune
# named with Home in the name

clearignore 
unsetvar 'gfto'
while findtype 8901 'backpack' as 'runeBook'
    getlabel 'runeBook' 'runeBookLabel'
    if 'Home' in 'runeBookLabel'
        setvar 'gtfo' 'runeBook'
        overhead 'Set recall to rune book'
    endif
    @ignore 'runeBook'
endwhile
while findtype 7956 'backpack' as 'runeBook'
    getlabel 'runeBook' 'runeBookLabel'
    if 'Home' in 'runeBookLabel'
        setvar 'gtfo' 'runeBook'
        overhead 'Set recall to rune book'
    endif
    @ignore 'runeBook'
endwhile
  
if not varexist 'gtfo'
    overhead 'You need a book or rune named Home' 33
    wait 500
    overhead 'You need a book or rune named Home' 33
    wait 500
    overhead 'You need a book or rune named Home' 33
    wait 500
    elseif skill magery >= 60
    overhead 'Spell Cast'
    cast 'recall'
    wft 5000
    target 'gtfo'
elseif findtype 8012 'backpack'as recallScrolls
    if skill magery >= 20
        overhead 'Recall Scroll'
        #We have magery but prefer scrolls
        dclick 'recallScrolls'
        wft 5000
        target 'gtfo'
    else 
        overhead 'Book use'
        #We have loose recalls but recall with book
        dclick 'gtfo'
        wait 250
        gumpresponse 2    
    endif
else
    #Book use
    overhead 'Book use'
    dclick 'gtfo'
    wait 250
    gumpresponse 2        
endif
overhead "Landed now walking"
#walk in one past doors so horses move
while not position 4007 904 5
    walk 'North'
    wait 150
endwhile

while findtype 7133 backpack as 'myLogs'
  dclicktype '3908' 
  wft 500
  target 'myLogs'
  wait 150
endwhile

#open packhorses
dclick pack1
wait 500
dclick pack2
wait 500
dclick pack3
wait 500
dclick pack4
wait 500

while findtype 6585 'pack1' as 'myingots'
  dclick 'myingots'
  wait 150
endwhile
while findtype 6585 'pack2' as 'myingots'
  dclick 'myingots'
  wait 150
endwhile
while findtype 6585 'pack3' as 'myingots'
  dclick 'myingots'
  wait 150
endwhile
while findtype 6585 'pack4' as 'myingots'
  dclick 'myingots'
  wait 150
endwhile

//open all the boxes
//dclick 0x433D6209
//wait 500
//dclick 0x451BB7AB
//wait 500
//dclick 0x440C329C
//wait 500
//dclick 0x51E8CEEE
//wait 500
//dclick 0x4310EA76
//wait 500
//dclick 0x5245AE7A
//wait 500
//dclick 0x4E850FAC
//wait 1000

//dump all supply shelf
menu 0x407F8ACB 0
waitfortarget
target 'self'
wait 500
gumpclose
wait 500

//dump all resources
menu 0x4004288C 0
waitfortarget 
target 'self'
wait 500


//Target the resupply cabinet here
overhead 'Restock' 25
menu 0x407F8ACB 1
wait 500
